---
title: "Claude Codeの設定、どこに何を書けばいい？〜3層構成の考え方"
date: 2025-01-19
draft: false
tags: ["Claude Code", "AI", "ナレッジマネジメント", "プロンプト設計"]
---

Claude Codeを使い始めて数日。CLAUDE.mdやSkills、Rulesなど、どこにどんな指示を書けばいいのか試行錯誤している。

## AIは超賢いけど記憶喪失

Xで「AIは超賢いけど記憶喪失」という表現を見かけた。ChatGPTは比較的記憶力がいいという話も流れてきて、これは私の体感とも合っている。

Claude Codeでは会話を変えると、昨日の会話すら何も覚えていないというイメージ。毎回まっさらな状態からスタートする感じだ。でもCodexと比較してるわけではないので、もしかしたら、これは汎用ブレインとコーディングアシスタントの違いなのかな？　

いずれにしてもAIは人間と比べて記憶力が弱いというのは間違いない。だからこそ「何を覚えさせておくか」の設計が重要になってくる。

## 3層構成という考え方

[れんさんの記事](https://note.com/ren_ai_coach/n/n25d91547a3cb)で「3層構成」という考え方を知った。

ポイントは2つ：

1. **「ルールを書く」から「コンテキストを設計する」へ**
2. **ルールファイルはLLMを矯正する場所というより「どの知識を渡すか」の入口**

つまり、AIに「こうしろ」と命令するのではなく、「こういう前提知識を持った状態で仕事してね」と設計する発想だ。

## 実際にやってみて困ったこと

### CLAUDE.mdはどこに置く？

昨日、Obsidianボルト内でLearning Blogの構築をClaudeと相談した。会話自体はボルト内でしていたが、`dev`フォルダ内には別途プロジェクトフォルダがあり、そこにPythonやHugoのプログラムや設定が置いてあった。

そこで疑問が出た。CLAUDE.mdはボルト側とプロジェクト側、どっちに何を書く？

Claudeに聞いたら「プロジェクト固有のことはプロジェクト内に置いた方がいい」とのこと。ただし、**ボルト内で会話しているときは、別のプロジェクトのCLAUDE.mdは読みに行かない**らしい。読みに行かないとのことなので、今回はボルト内のCLAUDE.mdに記載することにした。

### 「都度参照」のメカニズムがわからない

3層構成の記事では、技術ごとの注意点などは小さいRulesファイルに切り出して「都度参照」させると書いてあった。

でも、この「都度参照」が具体的にどう動くのかわからない。大元のCLAUDE.mdに「これを聞かれたらこのファイルを参照」と書いておくのだろうか？

昨日、Claude Codeに聞いた感じだと、そのままでは都度参照しない感じだった。なので、とりあえず今回はボルト内のCLAUDE.mdに書くことにした。次のプロジェクトを作るときに、またAIに相談するか、他の人のベストプラクティスを見つけたら、積極的に取り入れていきたい。


### 汎用スキルとプロジェクト専用のルールの切り分け

最終的に、ボルト内CLAUDE.mdに記述してもらったワークフローの全容は、人間が読んでもかなりわかりやすい、良いものだった。
ブログを書いたら毎回英語版を作ってもらうことにしたので、直訳っぽくなく「自然な英語にリライトして」というお願いも今回はCLAUDE.mdへ。

でも、「自然な英語にリライト」というのは汎用スキルな気もするので、そのうちSkillsとして切り出ししていけるのかも試行錯誤していきたい。


## まだ模索中

正直、まだベストプラクティスは見えていない。

AIに「設定のベストプラクティスを教えて」と聞いても、Yesmanな回答が返ってくるだけだったりする。実際に使いながら、自分のワークフローに合った形を見つけていきたい。

今のところの理解：
- **CLAUDE.md** → プロジェクトの概要、基本的な文脈
- **Skills** → 繰り返し使う具体的なタスクの手順
- **Rules** → 小さな注意点や制約（技術固有のやらかし防止など）

引き続き試行錯誤していく。
